record (longin, "${UUT}:${SITE}:AWG:LENGTH") {
    field(DTYP, "stream")
    field(INP,  "@awg.proto getML(${UUT}:${SITE}:AWG:MODE) ${SPORT}")
    field(SCAN, ".2 second")
    field(DESC, "AWG waveform length in samples")    
    field(FLNK, "${UUT}:${SITE}:AWG:LENGTH:PCT")   
}

record (longout, "${UUT}:${SITE}:AWG:BURSTLEN") {
	field(DTYP, "stream")
	field(OUT, "@awg.proto setBurstLen ${SPORT}")
	field(FLNK, "${UUT}:${SITE}:AWG:BURSTMODE")
	field(DRVL, "0")
	field(DRVH, "1048576")
}
record (calcout, "${UUT}:${SITE}:AWG:BURSTMODE") {
	field(INPA, "${UUT}:${SITE}:AWG:BURSTLEN")
	field(CALC, "A != 0")
	field(FLNK, "${UUT}:${SITE}:AWG:BURSTMODE:w PP")
}
record(bo, "${UUT}:${SITE}:AWG:BURSTMODE:w") {
	field(DTYP, "Soft Channel")
#	field(DTYP, "stream")
#	field(OUT, "@cpdac.proto setBurstMode ${SPORT}")
	field(OMSL, "closed_loop")
	field(DOL,  "${UUT}:${SITE}:AWG:BURSTMODE")
}

record (longin, "${UUT}:${SITE}:AWG:MAXLEN") {
    field(DTYP, "stream")
    field(INP,  "@awg.proto getMaxlen ${SPORT}")
    field(DESC, "AWG expected waveform length")
    field(SCAN, ".2 second")    
}
record (longin, "${UUT}:${SITE}:AWG:CURSOR") {
	field(DTYP, "stream")
	field(INP,  "@awg.proto getCursor ${SPORT}")
	field(DESC, "AWG current playback position")
	field(SCAN, ".2 second")
	field(FLNK, "${UUT}:${SITE}:AWG:CURSOR:PCT")
}

record(calc, "${UUT}:${SITE}:AWG:CURSOR:PCT") {
    field(INPA, "${UUT}:${SITE}:AWG:CURSOR")
    field(INPB, "${UUT}:${SITE}:AWG:LENGTH")
    field(INPC, "${UUT}:${SITE}:AWG:MAXLEN")
    field(CALC, "(C? A/C: A/B)*100")
    field(LOPR, "0")
    field(HOPR, "100")
}

record(calc, "${UUT}:${SITE}:AWG:LENGTH:PCT") {
    field(INPA, "${UUT}:${SITE}:AWG:CURSOR")
    field(INPB, "${UUT}:${SITE}:AWG:LENGTH")
    field(INPC, "${UUT}:${SITE}:AWG:MAXLEN")
    field(CALC, "(C? B/C: 1)*100")
    field(LOPR, "0")
    field(HOPR, "100")
}
record (longin, "${UUT}:${SITE}:AWG:REPS:rc") {
	field(DTYP, "stream")
	field(INP, "@awg.proto getReps ${SPORT}")
	field(DESC, "AWG number of cycles")
	field(SCAN, "1 second")	
}
record (longin, "${UUT}:${SITE}:AWG:ACTIVE") {
	field(DTYP, "stream")
	field(INP, "@awg.proto getActive ${SPORT}")
	field(DESC, "AWG is active")
	field(SCAN, "1 second")
	field(FLNK, "${UUT}:${SITE}:AWG:DUTY PP")
}

record (calc, "${UUT}:${SITE}:AWG:DUTY") {
	field(INPA, "${UUT}:${SITE}:SIG:clk_count:FREQ")
	field(INPB, "${UUT}:${SITE}:SIG:sample_count:FREQ")
	field(INPC, "${UUT}:${SITE}:AWG:ACTIVE")
	field(CALC,  "C!=0 && A!=0? B/A*100.0: 0")
	field(EGU,   "%")
}
record (mbbi, "${UUT}:${SITE}:AWG:MODE") {
	field(DTYP, "Soft Channel")
	field(ZRST, "continuous")
	field(ONST, "oneshot")
	field(TWST, "oneshot_rearm")
	field(DESC, "AWG operating mode")
	field(NOBT, "2")	
}

record (bo, "${UUT}:${SITE}:AWG:MODE:ABO") {
	field(DTYP, "stream")
	field(OUT,  "@awg.proto setAbort ${SPORT}" )
	field(DESC, "AWG operating mode: set oneshot to quit")
	field(HIGH, "2")
}


record (bi, "${UUT}:${SITE}:AWG:ARM") {
	field(DTYP, "stream")
	field(INP, "@awg.proto getArm ${SPORT}")
	field(SCAN, ".5 second")
	field(DESC, "AWG is ARMED")
	field(ZNAM, "0")
	field(ONAM, "1")	
	field(PINI, "YES")
}

record (longin, "${UUT}:${SITE}:AWG:COMPLETED_SHOT") {
       field(DTYP, "stream")
       field(INP, "@awg.proto getCompletedShot ${SPORT}")
       field(SCAN, ".2 second")
       field(DESC, "Shot number last complete shot")
       field(PINI, "YES")
       field(FLNK, "${UUT}:${SITE}:AWG:SHOT_COMPLETE")
}

record (calc, "${UUT}:${SITE}:AWG:SHOT_COMPLETE") {
    	field(INPA, "${UUT}:${SITE}:SHOT")  
    	field(INPB, "${UUT}:${SITE}:AWG:COMPLETED_SHOT")
    	field(CALC, "A && A==B")       
}

record(stringout, "${UUT}:${SITE}:AWG:SITES") {
	field(DTYP, "Soft Channel")
	field(VAL,  "${dsites}")
	field(PINI, "YES")
}

record(stringout, "${UUT}:${SITE}:AWG:SITES:n") {
	field(DTYP, "Soft Channel")
	field(VAL,  "none")
	field(PINI, "YES")
}

record(stringin, "${UUT}:${SITE}:AWG:SITES:r") {
	field(DTYP, "stream")
	field(INP, "@acq400mb.proto getDistributorSites S0")
	field(SCAN, "I/O Intr")
}

record(bo, "${UUT}:${SITE}:AWG:SITES:s") {
	field(DTYP, "Soft Channel")
	field(DOL,  "${UUT}:${SITE}:AWG:SITES:r NPP")
	field(OMSL, "closed_loop")
	field(OUT,  "${UUT}:${SITE}:AWG:SITES PP")
}


record(stringout, "${UUT}:${SITE}:AWG:SITES:w") {
	field(DTYP, "stream")
	field(OUT, "@acq400mb.proto setDistributorSites S0")
	field(DISV, "1")
	field(SDIS, "${UUT}:${SITE}:AWG:SITES:s.PACT")
}

record(bo, "${UUT}:1:AWG:DIST") {
	field(DTYP, "Soft Channel")
	field(ZNAM, "DC")
	field(ONAM, "AWG")
	field(VAL,  "0")
	field(PINI, "YES")	
}





