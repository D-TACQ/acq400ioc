
# in addition to acq2006clktree.db

record (bo, "${UUT}:SYS:CLK:FP_NOT_HDMI") {
	field(DTYP, "Soft Channel")
	field(ZNAM, "HDMI")
	field(ONAM, "FP")	
	field(FLNK, "${UUT}:SYS:CLK:fpnhdmi0")
	field(VAL,  "0")
	field(PINI, "YES")
}


# 5:: FP_NOT_HDMI
record(calcout, "${UUT}:SYS:CLK:FP_NOT_HDMI:w"){
	field(INPA, "${UUT}:0:SIG:SRC:CLK:0")
	field(CALC, "A==5")                  
	field(OUT,  "${UUT}:SYS:CLK:FP_NOT_HDMI PP")
	field(FLNK, "${UUT}:SYS:CLK:FP_NOT_HDMI:w2")
}

# 5:FP_NOT_HDMI OR FPMUX=2:FPCLK :: enable front side FPCLK switch (else off for noise purposes.
record(calcout, "${UUT}:SYS:CLK:FP_NOT_HDMI:w2"){
	field(INPA, "${UUT}:0:SIG:SRC:CLK:0")
	field(INPB, "${UUT}:SYS:CLK:FPMUX")
	field(CALC, "A==5||B==2")
	field(OUT,  "${UUT}:SYS:CLK:_FP_OE PP")
}

# enable FPCLK (needed if  ${UUT}:SYS:CLK:FPMUX is not FPCLK)
record (mbbo, "${UUT}:0:SIG:SRC:CLK:0:w") {
	field(DOL,  "${UUT}:0:SIG:SRC:CLK:0.RVAL")
	field(FLNK, "${UUT}:SYS:CLK:FP_NOT_HDMI:w")
}


record (mbbo, "${UUT}:0:SIG:SRC:CLK:0") {
	field(DTYP, "Soft Channel")
	field(FVST, "FP")
	field(SDEF, "1")
	field(ZRVL, "0")
	field(ONVL, "1")	       # HDMI
	field(TWVL, "2")
	field(THVL, "3")
	field(FRVL, "4")
	field(FVVL, "1")               # HDMI
}

# disable the feedback when logical 5 selected (because it's actually physical 1)
record(mbbi, "${UUT}:0:SIG:SRC:CLK:0:r") {
	field(SDIS, "${UUT}:0:SIG:SRC:CLK:0")
	field(DISV, "5")
}

# break before make .. 
record (calcout, "${UUT}:SYS:CLK:fpnhdmi0") {
	field(INPA, "0")
	field(CALC, "A")
	field(OUT, "${UUT}:SYS:CLK:_FP_CLK2_OE PP")
	field(FLNK, "${UUT}:SYS:CLK:fpnhdmi1")	
}

record (calcout, "${UUT}:SYS:CLK:fpnhdmi1") {
	field(INPA, "0")
	field(CALC, "A")
	field(OUT, "${UUT}:SYS:CLK:_HDMI_CLK_OE PP")
	field(FLNK, "${UUT}:SYS:CLK:fpnhdmi2")	
}

# maybe make FP
record (calcout, "${UUT}:SYS:CLK:fpnhdmi2") {
	field(INPA, "${UUT}:SYS:CLK:FP_NOT_HDMI")
	field(CALC, "A")
	field(OUT, "${UUT}:SYS:CLK:_FP_CLK2_OE PP")
	field(FLNK, "${UUT}:SYS:CLK:fpnhdmi3")
}

# maybe make HDMI
record (calcout, "${UUT}:SYS:CLK:fpnhdmi3") {
	field(INPA, "${UUT}:SYS:CLK:FP_NOT_HDMI")
	field(CALC, "!A")
	field(OUT, "${UUT}:SYS:CLK:_HDMI_CLK_OE PP")
}

record (bo, "${UUT}:SYS:CLK:_FP_CLK2_OE") {
	field(ONAM, "ON")
	field(ZNAM, "OFF")
	field(DESC, "Front Panel Clock2 Output En")
	field(DTYP, "boAcqHost")
	field(OUT, "@/dev/gpio/FP_CLK2_OE")
	
}

record (bo, "${UUT}:SYS:CLK:_HDMI_CLK_OE") {
	field(ONAM, "ON")
	field(ZNAM, "OFF")
	field(DESC, "HDMI_CLK Output En")
	field(DTYP, "boAcqHost")
	field(OUT, "@/dev/gpio/HDMI_CLK_OE")
		
}

