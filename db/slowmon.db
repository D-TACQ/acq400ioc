# SLOWMON : slow rate monitoring


record(bo, "${UUT}:NACC:DNA") {
	field(DTYP, "stream")
	field(DESC,  "Direct not Accumulate")
	field(OUT,  "@slowmon.proto setDNA ${SPORT}")
	field(ZNAM, "ACC")
	field(ONAM, "DIR")
	field(VAL,  "1")
	field(PINI, "YES")	
}

record(longout, "${UUT}:0:SLOWMON:FS") {
	field(DTYP, "stream")
	field(DESC, "SLOWMON output sample rate")
	field(OUT,  "@slowmon.proto setSlowmonFs S0")
	field(DRVL, "1")
	field(DRVH, "64")
	field(EGU,  "Hz")
	field(FLNK, "${UUT}:0:SLOWMON:NACC")
}
	
record(longout, "${UUT}:0:SLOWMON:FIN") {
	field(DTYP, "stream")
	field(DESC, "SLOWMON input sample rate from HW")
	field(OUT,  "@slowmon.proto setSlowmonFin S0")
	field(DRVL, "1")
	field(DRVH, "${FIN_MAX}")
	field(EGU,  "Hz")
	field(FLNK, "${UUT}:0:SLOWMON:NACC")
}

record(longin, "${UUT}:0:SLOWMON:FIN:ACT") {
	field(DTYP, "Soft Channel")	
	field(DESC, "SLOWMON FIN actual")
	field(EGU,  "Hz")
}

record(calc, "${UUT}:0:SLOWMON:NACC") {
	field(DESC, "Software Accumulate")
	field(INPA, "${UUT}:0:SLOWMON:FS")
	field(INPB, "${UUT}:0:SLOWMON:FIN")
	field(CALC, "floor(B/A)")
	field(FLNK, "${UUT}:0:SLOWMON:FS:ACT")
}

record(calc, "${UUT}:0:SLOWMON:FS:ACT") {
	field(DESC, "Software FS, Actual")
	field(INPA, "${UUT}:0:SLOWMON:FIN:ACT")
	field(INPB, "${UUT}:0:SLOWMON:NACC")
	field(CALC, "floor(A/B)")
	field(FLNK, "${UUT}:NACC:c")
}
	
record(longout, "${UUT}:0:NACC:NACC") {
	field(DTYP, "Soft Channel")
	field(DESC, "NACC filter N value")
	field(DRVL, "1")
	field(DRVH, "256")
	field(FLNK, "${UUT}:NACC:c")
}

record(longout, "${UUT}:0:NACC:START") {
	field(DTYP, "Soft Channel")
	field(DESC, "NACC filter Start for non**2")
	field(DRVL, "0")
	field(DRVH, "255")
}

record(longout, "${UUT}:0:NACC:SHR") {
	field(DTYP, "Soft Channel")
	field(DESC, "NACC scaling >> N")
	field(DRVL, "0")
	field(DRVH, "16")
}
	
record(longout, "${UUT}:0:NACC:PRES") {
	field(DTYP, "Soft Channel")
	field(DESC, "NACC filter PREScale value **2")
	field(VAL,  "1")
	field(PINI, "YES")
	field(DRVL, "1")
	field(DRVH, "${PRESMAX}")
}

record(calcout, "${UUT}:NACC:c") {
	field(DTYP, "stream")
	field(INPA, "${UUT}:0:NACC:NACC")
	field(INPB, "${UUT}:0:NACC:SHR")
	field(INPC, "${UUT}:0:NACC:START")	
	field(INPD, "${UUT}:0:NACC:PRES")
	field(OUT,  "@slowmon.proto setNACC ${SPORT}")
}
