record(longin, "${UUT}:${SITE}:SIG:${lname}:rawcount") {
	field(SCAN, "1 second")
	field(DTYP, "longinAcqHost")
	field(INP,  "@/dev/acq420.${SITE}.knobs/${lname}")
	field(DESC, "LRU:${UUT}:${SITE} CLK STAT ${lname}")
	field(SCAN, "1 second")
	field(FLNK, "${UUT}:${SITE}:SIG:${lname}:ACTIVE")
	field(PRIO, "HIGH")
}

record(calc, "${UUT}:${SITE}:SIG:${lname}:ACTIVE") {
	field(INPA, "${UUT}:${SITE}:SIG:${lname}:rawcount")
	field(INPB, "${UUT}:${SITE}:SIG:${lname}:ACTIVE.LA")
	field(CALC, "(A-B) ? 1: 0")
	field(PREC, "1")
	field(FLNK, "${UUT}:${SITE}:SIG:${lname}:COUNT")
	field(DESC, "LRU:${UUT}:${SITE} CLK ACTIVE ${lname}")
}

record(calc, "${UUT}:${SITE}:SIG:${lname}:COUNT") {
	field(INPA, "${UUT}:${SITE}:SIG:${lname}:rawcount")
	field(INPB, "${UUT}:${SITE}:SIG:${lname}:COUNT.LA")
	field(INPC, "268435456")
	field(CALC, "A==0 && B==0? 0: A > B? VAL+(A-B): VAL+(A+C-B)")
	field(FLNK, "${UUT}:${SITE}:SIG:${lname}:delta")
	field(DESC, "64 bit count detects and corrects 28 bit rollover")
}

record(calc, "${UUT}:${SITE}:SIG:${lname}:delta") {
	field(INPA, "${UUT}:${SITE}:SIG:${lname}:COUNT")
	field(INPB, "${UUT}:${SITE}:SIG:${lname}:delta.LA")
	field(CALC, "A > B && B != 0 ? A-B: 0")
	field(DESC, "computes count difference")
	field(FLNK, "${UUT}:${SITE}:SIG:${lname}:nzcount")
}

record(calc, "${UUT}:${SITE}:SIG:${lname}:nzcount") {
	field(INPA, "${UUT}:${SITE}:SIG:${lname}:COUNT")
	field(DESC, "computes number of non-zero samples")
	field(CALC, "A == 0? 0: VAL+1")
	field(FLNK, "${UUT}:${SITE}:SIG:${lname}:FREQ")
}
record(calc, "${UUT}:${SITE}:SIG:${lname}:FREQ") {
	field(INPA, "${UUT}:${SITE}:SIG:${lname}:delta")
	field(INPB, "${UUT}:${SITE}:SIG:${lname}:FREQ.LA")
	field(INPC, "${UUT}:${SITE}:SIG:${lname}:FREQ.LB")
	field(INPD, "${UUT}:${SITE}:SIG:${lname}:FREQ.LC")
	field(INPE, "${UUT}:${SITE}:SIG:${lname}:FREQ.LD")
	field(INPF, "${UUT}:${SITE}:SIG:${lname}:FREQ.LE")
	field(INPG, "${UUT}:${SITE}:SIG:${lname}:FREQ.LF")
	field(INPH, "${UUT}:${SITE}:SIG:${lname}:FREQ.LG")
	field(INPL, "${UUT}:${SITE}:SIG:${lname}:nzcount")
	field(CALC, "A==0? 0: (A+(L>8? B+C+D+E+F+G+H: 0))/(L>8? 8: 1)")
	field(PREC, "0")
	field(EGU,  "Hz")
	field(DESC, "LRU:${UUT}:${SITE} CLK FREQ ${lname}")
}

