record (stringout, "${UUT}:SYS:SYNC_ROLE") {
	field(DTYP, "Soft Channel")
	field(FLNK, "${UUT}:SYS:SYNC_ROLE:w PP")
}


record (stringout, "${UUT}:SYS:SYNC_ROLE:w") {
	field(DTYP, "stream")
	field(OUT,  "@sync_role.proto set_sync_role ${SPORT}")
	field(OMSL, "closed_loop")
	field(DOL,  "${UUT}:SYS:SYNC_ROLE")
	field(SDIS, "${UUT}:SYS:SYNC_ROLE:s.PACT")
	field(DISV, "1")
}


record (stringin, "${UUT}:SYS:SYNC_ROLE:r") {
	field(DTYP, "stream")
	field(INP,  "@sync_role.proto get_sync_role ${SPORT}")
	field(SCAN, "2 second")
	field(FLNK, "${UUT}:SYS:SYNC_ROLE:s")
}

record(longin, "${UUT}:SYS:SYNC_ROLE:FS:r") {
        field(DTYP, "stream")
        field(INP,  "@sync_role.proto get_sync_role_fs ${SPORT}")
        field(SCAN, "2 second")
        field(FLNK, "${UUT}:SYS:SYNC_ROLE:FS:s PP")
}

record(calcout, "${UUT}:SYS:SYNC_ROLE:FS:s") {
        field(INPA, "${UUT}:SYS:SYNC_ROLE:FS:r")
        field(CALC, "A > 1000? A: 0")
        field(DOPT, "Use CALC")
        field(OOPT, "On Change")
        field(OUT, "${UUT}:SYS:SYNC_ROLE:FS PP")
}

record(longout, "${UUT}:SYS:SYNC_ROLE:FS") {
        field(DTYP, "Soft Channel")
        field(EGU, "Hz")
        field(FLNK, "${UUT}:SYS:SYNC_ROLE:FS:w")
}

record(longout, "${UUT}:SYS:SYNC_ROLE:FS:w") {
        field(DTYP, "Soft Channel")
        field(EGU, "Hz")
        field(DOL,  "${UUT}:SYS:SYNC_ROLE:FS")
        field(OMSL, "closed_loop")
        field(OUT,  "${UUT}:1:INTCLK_HZ PP")
        field(FLNK, "${UUT}:1:INTCLK_HZ")
}



record (stringout, "${UUT}:SYS:SYNC_ROLE:s") {
	field(DTYP, "Soft Channel")
	field(OMSL, "closed_loop")
	field(DOL,  "${UUT}:SYS:SYNC_ROLE:r NPP")
	field(OUT,  "${UUT}:SYS:SYNC_ROLE PP")
}

record(bo, "${UUT}:0:COUNTER_LATCH:REQ") {
	field(DTYP, "Soft Channel")
	field(DESC, "Counter latch request eg gps")
	field(ZNAM, "0")
	field(ONAM, "1")	
	field(FLNK, "${UUT}:0:COUNTER_LATCH:c")
}


record(calcout, "${UUT}:0:COUNTER_LATCH:c") {
	field(INPA, "${UUT}:0:COUNTER_LATCH:REQ")
# INP may be overridden eg by wr.db	
	field(INPB, "0") 
	field(INPC, "${UUT}:0:SIG:SYN_EXT:ACTIVE")
	
	field(CALC, "(A||B)&&C")	
	field(OUT,  "${UUT}:0:COUNTER_LATCH PP")
	field(DOPT, "Use CALC")
	field(OOPT, "On Change")
	field(SCAN, "2 second")
}




record(bo, "${UUT}:0:COUNTER_LATCH") {
	field(DESC, "$placeholder")
	field(DTYP, "stream")	
	field(DOL,  "${UUT}:0:COUNTER_LATCH:c")
	field(OMSL, "closed_loop")
	field(OUT,  "@sync_role.proto setCounterLatch ${SPORT}")
	field(ZNAM, "0")
	field(ONAM, "1")
	field(PINI, "YES")
}

record(mbbo, "${UUT}:SYS:SYNC_ROLE:SET:ROLE" ) {
	field(DTYP, "Soft Channel")
	field(NOBT, "3")
	field(ZRST, "solo")
	field(ONST, "slave")
	field(TWST, "master")
	field(THST, "fpmaster")
	field(FRST, "rpmaster")
	field(VAL,  "0")
	field(PINI, "YES")
}

record(mbbo, "${UUT}:SYS:SYNC_ROLE:SET:FS" ) {
	field(DTYP, "Soft Channel")
	field(NOBT, "4")	
	field(ZRST, "1")
	field(ONST, "2")
	field(TWST, "5")
	field(THST, "10")
	field(FRST, "20")
	field(FVST, "50")
	field(SXST, "100")
	field(SVST, "200")
	field(EIST, "500")
	field(VAL,  "4")
	field(PINI, "YES")
}

record(mbbo, "${UUT}:SYS:SYNC_ROLE:SET:FS:M" ) {
	field(DTYP, "Soft Channel")
	field(NOBT, "1")
	field(ZRST, "k")
	field(ONST, "M")
	field(VAL,  "0")
	field(PINI, "YES")
}

record(mbbo, "${UUT}:SYS:SYNC_ROLE:SET:FIN" ) {
	field(DTYP, "Soft Channel")
	field(NOBT, "4")	
	field(ZRST, "1")
	field(ONST, "2")
	field(TWST, "5")
	field(THST, "10")
	field(FRST, "20")
	field(FVST, "50")
	field(SXST, "100")
	field(SVST, "200")
	field(EIST, "500")
	field(VAL,  "0")
	field(PINI, "YES")	
}

record(mbbo, "${UUT}:SYS:SYNC_ROLE:SET:FIN:M" ) {
	field(DTYP, "Soft Channel")
	field(NOBT, "1")
	field(ZRST, "k")
	field(ONST, "M")
	field(VAL,  "1")
	field(PINI, "YES")
}

record(mbbo, "${UUT}:SYS:SYNC_ROLE:SET:MODIFIER" ) {
	field(DTYP, "Soft Channel")
	field(NOBT, "3")
	field(ZRST, "-")
	field(ONST, "EXT TRG RISING")
	field(TWST, "EXT TRG FALLING")	
	field(THST, "EXT CLK RISING")
	field(FRST, "EXT CLK FALLING")
	field(VAL,  "0")
	field(PINI, "YES")
}


record(bo, "${UUT}:SYS:SYNC_ROLE:SET"){
	field(DESC, "$placeholder")
	field(DTYP, "Soft Channel")
	field(ZNAM, "-")
	field(ONAM, "COMMIT")
}




